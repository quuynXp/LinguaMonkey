# FILE: render.yaml (ƒê√£ b·ªï sung autoDeploy: true)
---
services:
  # ... (Ph·∫ßn 1 v√† 2: Postgres v√† Redis ƒë√£ b·ªã lo·∫°i b·ªè/tham chi·∫øu)

  # === 3. BACKEND SERVICES ===
  - type: web
    name: linguavietnameseapp
    runtime: docker
    region: singapore
    plan: free
    autoDeploy: true # üëà K√≠ch ho·∫°t CI/CD t·ª± ƒë·ªông
    dockerContext: .
    dockerfilePath: ./LinguaVietnameseApp/Dockerfile
    envVars:
      # ... (C√°c bi·∫øn m√¥i tr∆∞·ªùng)
      - fromGroup: shared-app-env
    healthCheckPath: /actuator/health
    numInstances: 1

  - type: web
    name: pythonservice
    runtime: docker
    region: singapore
    plan: free
    autoDeploy: true # üëà K√≠ch ho·∫°t CI/CD t·ª± ƒë·ªông
    dockerContext: .
    dockerfilePath: ./PythonService/Dockerfile
    envVars:
      # ... (C√°c bi·∫øn m√¥i tr∆∞·ªùng)
      - fromGroup: shared-app-env
    numInstances: 1
    port: 8001

  # === 4. KONG GATEWAY (DB-LESS) ===
  - type: web
    name: kong
    runtime: image
    image:
      url: kong:3.4
    region: singapore
    plan: free
    autoDeploy: true # üëà K√≠ch ho·∫°t CI/CD t·ª± ƒë·ªông
    dependsOn:
      - linguavietnameseapp
      - pythonservice
    envVars:
      # ... (C√°c bi·∫øn m√¥i tr∆∞·ªùng Kong)
    ports:
      - port: 8000
      - port: 8001
    disk:
      - name: kong-config
        mountPath: /usr/local/etc/kong/kong.yml
    numInstances: 1

envVarGroups:
  - name: shared-app-env
    envVars:
      - key: ENVIRONMENT
        value: production